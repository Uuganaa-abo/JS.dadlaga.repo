<!DOCTYPE html>
<html>
  <head>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bulma@1.0.0/css/bulma.min.css"
    />
    <style>
      .area {
        background-color: rgb(199, 239, 203);
        position: relative;
      }
      .head {
        width: 20px;
        height: 20px;
        background-color: black;
        position: absolute;
        display: none;
      }
      .food {
        width: 20px;
        height: 20px;
        background-color: red;
        position: absolute;
        top: 100px;
        left: 100px;
      }
    </style>
  </head>
  <body onkeydown="handleKeydown(event);">
    <div class="area" id="area">
      <div class="head" id="head" style="top: 100px"></div>
      <div class="food" id="food"></div>
    </div>
    <button onclick="changeDirection('up');" class="button is-danger is-inverted">Up</button>
    <button onclick="changeDirection('down');" class="button is-danger is-inverted ">Down</button>
    <button onclick="changeDirection('right');" class="button is-danger is-inverted">Right</button>
    <button onclick="changeDirection('left');" class="button is-danger is-inverted">left</button>

    <script>
      const scale = 20;
      const head = document.getElementById("head");
      const area = document.getElementById("area");

      const areaWidth = 20;
      const areaHeight = 20;

      const food = {
        x: 5,
        y: 5,
      };

      let direction = "up";
      function resetGame() {
        area.style.width = `${areaWidth * scale}px`;
        area.style.height = `${areaHeight * scale}px`;
        head.style.display = "block";
        render();
      }

      function handleKeydown(event) {
        console.log(event.key);
        switch (event.key) {
          case "ArrowUp":
          case "w":
            changeDirection("up");
            break;
          case "ArrowDown":
          case "S":
            changeDirection("down");
            break;
          case "ArrowRight":
          case "D":
            changeDirection("right");
            break;
          case "ArrowLeft":
          case "a":
            changeDirection("left");
            break;
        }
      }

      let positionX = 5;
      let positionY = 5;

      function changeDirection(value) {
        if (direction === "left" || direction === "right") {
          if (value === "up" || value === "down") {
            direction = value;
          }
        } else if (direction === "down" || direction === "up") {
          if (value === "right" || value === "left") {
            direction = value;
          }
        }
      }

      const goRight = () => {
        positionX += 1;
        if (positionX > areaWidth - 1) {
          positionX = 0;
        }
      }
      const goLeft = () => {
        positionX -= 1;
        if (positionX < 0) {
          positionX = areaWidth - 1;
        }
      }
      const goDown = () => {
        positionY += 1;
        if (positionY > areaHeight - 1) {
          positionY = 0;
        }
      }
      const goUp = () => {
        positionY -= 1;
        if (positionY < 0) {
          positionY = areaHeight - 1;
        }
      }

      function render() {
        if (food.x === positionX && food.y === positionY) {
          console.log("Swallowed food");
        }
        head.style.left = `${positionX * scale}px`;
        head.style.top = `${positionY * scale}px`;
      }

      function gameLoop() {
        switch (direction) {
          case "up":
            goUp();
            break;
          case "down":
            goDown();
            break;
          case "right":
            goRight();
            break;
          case "left":
            goLeft();
            break;
        }
        render();
      }
      resetGame();

      let speed = 200;
      setInterval(gameLoop, speed);
    </script>
  </body>
</html>
