<!DOCTYPE html>
<html>
  <head>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bulma@1.0.0/css/bulma.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
    />
    <style>
      .area {
        background-color: rgb(199, 239, 203);
        position: relative;
      }
      .part {
        width: 10px;
        height: 10px;
        background-color: black;
        position: absolute;
        border-radius: 7px;
      }
      .food {
        width: 10px;
        height: 10px;
        background-color: red;
        position: absolute;
        border-radius: 10px;
      }
    </style>
  </head>
  <body onkeydown="handleKeydown(event);">
    <div class="container" class="mx-auto">
      <div class="area" id="area">
        <div class="food" id="food"></div>
        <div id="body"></div>
      </div>
      <button
        onclick="changeDirection('up');"
        class="button is-danger is-inverted"
      >
        <i class="fa-solid fa-arrow-up-long"></i>
      </button>
      <button
        onclick="changeDirection('down');"
        class="button is-danger is-inverted"
      >
        <i class="fa-solid fa-arrow-down-long"></i>
      </button>
      <button
        onclick="changeDirection('right');"
        class="button is-danger is-inverted"
      >
        <i class="fa-solid fa-arrow-right-long"></i>
      </button>
      <button
        onclick="changeDirection('left');"
        class="button is-danger is-inverted"
      >
        <i class="fa-solid fa-arrow-left-long"></i>
      </button>
    </div>
    <script>
      const scale = 10;
      const area = document.getElementById("area");
      const foodat = document.getElementById("food");
      const areaWidth = 30;
      const areaHeight = 30;
      let positionX = 5;
      let positionY = 5;
      const bodyCoordinates = [
        { x: 7, y: 5 },
        { x: 8, y: 5 },
        { x: 9, y: 5 },
        { x: 10, y: 5 },
      ];

      const food = {
        x: 5,
        y: 5,
      };

      let direction = "up";
      function resetGame() {
        area.style.width = `${areaWidth * scale}px`;
        area.style.height = `${areaHeight * scale}px`;
        render();
      }

      function handleKeydown(event) {
        console.log(event.key);
        switch (event.key) {
          case "ArrowUp":
          case "w":
            changeDirection("up");
            break;
          case "ArrowDown":
          case "S":
            changeDirection("down");
            break;
          case "ArrowRight":
          case "D":
            changeDirection("right");
            break;
          case "ArrowLeft":
          case "a":
            changeDirection("left");
            break;
        }
      }
      function changeDirection(value) {
        if (direction === "left" || direction === "right") {
          if (value === "up" || value === "down") {
            direction = value;
          }
        } else if (direction === "down" || direction === "up") {
          if (value === "right" || value === "left") {
            direction = value;
          }
        }
      }

      const goRight = () => {
        positionX += 1;
        if (positionX > areaWidth - 1) {
          positionX = 0;
        }
      };
      const goLeft = () => {
        positionX -= 1;
        if (positionX < 0) {
          positionX = areaWidth - 1;
        }
      };
      const goDown = () => {
        positionY += 1;
        if (positionY > areaHeight - 1) {
          positionY = 0;
        }
      };
      const goUp = () => {
        positionY -= 1;
        if (positionY < 0) {
          positionY = areaHeight - 1;
        }
      };
      const bodyContainer = document.getElementById("body");
      function render() {
        if (food.x === positionX && food.y === positionY) {
          bodyCoordinates.unshift(bodyCoordinates[0]);

          food.x = Math.floor(Math.random() * scale);
          food.y = Math.floor(Math.random() * scale);
          foodat.style.top = `${food.y * scale}px`;
          foodat.style.left = `${food.x * scale}px`;
        }
        let bodyHtml = "";
        for (let i = 0; i < bodyCoordinates.length; i++) {
          bodyHtml += `<div class="part" style="top: ${
            bodyCoordinates[i].y * scale
          }px;
            left: ${bodyCoordinates[i].x * scale}px"></div>`;
        }
        bodyContainer.innerHTML = bodyHtml;
        foodat.style.top = `${food.y * scale}px`;
        foodat.style.left = `${food.x * scale}px`;
      }

      function gameLoop() {
        switch (direction) {
          case "up":
            goUp();
            break;
          case "down":
            goDown();
            break;
          case "right":
            goRight();
            break;
          case "left":
            goLeft();
            break;
        }
        bodyCoordinates.push({ x: positionX, y: positionY });
        bodyCoordinates.shift();
        render();
      }
      resetGame();
      let speed = 100;
      setInterval(gameLoop, speed);
    </script>
  </body>
</html>
